
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Magical Coloring Adventure - Math & Reading Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --purple-dark: #6B4C9A;
            --purple-mid: #9B7EBD;
            --purple-light: #D4C5E8;
            --blue-bright: #5B9FE3;
            --blue-sky: #A7D7F9;
            --pink-magic: #F5B7D5;
            --yellow-star: #FFD93D;
            --green-leaf: #7BC96F;
            --white-soft: #FFF8F0;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, var(--blue-sky) 0%, var(--purple-light) 50%, var(--pink-magic) 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            touch-action: pan-y;
        }

        /* Floating background decorations */
        .bg-decoration {
            position: fixed;
            opacity: 0.15;
            pointer-events: none;
            z-index: 0;
            animation: float 6s ease-in-out infinite;
        }

        .star1 { top: 10%; left: 15%; font-size: 40px; animation-delay: 0s; }
        .star2 { top: 20%; right: 20%; font-size: 30px; animation-delay: 1s; }
        .star3 { bottom: 15%; left: 10%; font-size: 35px; animation-delay: 2s; }
        .cloud1 { top: 30%; right: 10%; font-size: 50px; animation-delay: 0.5s; }
        .cloud2 { bottom: 25%; right: 25%; font-size: 45px; animation-delay: 1.5s; }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            animation: slideDown 0.8s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            font-family: 'Fredoka', sans-serif;
            font-size: 2.5em;
            color: var(--purple-dark);
            text-shadow: 3px 3px 0 var(--pink-magic), 5px 5px 0 var(--blue-bright);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.2em;
            color: var(--purple-mid);
            font-weight: 600;
        }

        .score-board {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(107, 76, 154, 0.3);
            display: flex;
            justify-content: space-around;
            align-items: center;
            animation: popIn 0.6s ease-out 0.2s both;
        }

        @keyframes popIn {
            0% { opacity: 0; transform: scale(0.8); }
            50% { transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }

        .score-item {
            text-align: center;
        }

        .score-label {
            font-size: 0.9em;
            color: var(--purple-mid);
            margin-bottom: 5px;
        }

        .score-value {
            font-family: 'Fredoka', sans-serif;
            font-size: 2em;
            color: var(--purple-dark);
            font-weight: 700;
        }

        .game-area {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            animation: popIn 0.6s ease-out 0.4s both;
        }

        .story-section {
            background: linear-gradient(135deg, var(--purple-light), var(--blue-sky));
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 4px solid var(--purple-mid);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .story-text {
            font-size: 1.3em;
            line-height: 1.8;
            color: var(--purple-dark);
            margin-bottom: 20px;
        }

        .question {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 15px;
            border-left: 6px solid var(--pink-magic);
            font-size: 1.2em;
            font-weight: 600;
            color: var(--purple-dark);
        }

        .answer-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .answer-btn {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.3em;
            padding: 20px;
            border: 4px solid var(--purple-mid);
            background: white;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--purple-dark);
            font-weight: 600;
            touch-action: manipulation;
        }

        .answer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(107, 76, 154, 0.3);
        }

        .answer-btn:active {
            transform: translateY(-1px);
        }

        .answer-btn.correct {
            background: var(--green-leaf);
            color: white;
            border-color: var(--green-leaf);
            animation: celebrate 0.6s ease;
        }

        .answer-btn.incorrect {
            background: #FF6B6B;
            color: white;
            border-color: #FF6B6B;
            animation: shake 0.4s ease;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(5deg); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .coloring-section {
            display: none;
            margin-top: 25px;
        }

        .coloring-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .coloring-instruction {
            text-align: center;
            font-size: 1.3em;
            color: var(--purple-dark);
            margin-bottom: 20px;
            font-weight: 600;
        }

        .color-palette {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .color-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 4px solid white;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            touch-action: manipulation;
        }

        .color-btn:hover {
            transform: scale(1.15);
        }

        .color-btn.selected {
            border-color: var(--purple-dark);
            border-width: 5px;
            transform: scale(1.2);
        }

        .canvas-container {
            text-align: center;
            margin-top: 20px;
        }

        canvas {
            border: 5px solid var(--purple-mid);
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            max-width: 100%;
            height: auto;
            touch-action: none;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.2em;
            padding: 15px 30px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            touch-action: manipulation;
        }

        .btn-next {
            background: var(--purple-mid);
            color: white;
            box-shadow: 0 5px 15px rgba(107, 76, 154, 0.4);
        }

        .btn-next:hover {
            background: var(--purple-dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(107, 76, 154, 0.5);
        }

        .btn-clear {
            background: var(--blue-bright);
            color: white;
            box-shadow: 0 5px 15px rgba(91, 159, 227, 0.4);
        }

        .btn-clear:hover {
            background: #4A8AD4;
            transform: translateY(-3px);
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 50px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            border: 6px solid var(--yellow-star);
        }

        .celebration.active {
            display: block;
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .celebration h2 {
            font-family: 'Fredoka', sans-serif;
            font-size: 3em;
            color: var(--purple-dark);
            margin-bottom: 20px;
        }

        .celebration p {
            font-size: 1.5em;
            color: var(--purple-mid);
            margin-bottom: 30px;
        }

        .feedback {
            text-align: center;
            margin-top: 15px;
            font-size: 1.2em;
            font-weight: 600;
            min-height: 30px;
        }

        .feedback.correct {
            color: var(--green-leaf);
        }

        .feedback.incorrect {
            color: #FF6B6B;
        }

        @media (max-width: 768px) {
            h1 { font-size: 2em; }
            .answer-options { grid-template-columns: 1fr; }
            .story-text { font-size: 1.1em; }
        }
    </style>
</head>
<body>
<a href="../" id="home-btn" style="position:fixed;top:12px;left:12px;z-index:9999;background:rgba(0,0,0,0.6);color:white;text-decoration:none;padding:8px 14px;border-radius:20px;font-family:'Comic Sans MS',cursive;font-size:16px;touch-action:manipulation;min-width:44px;min-height:44px;display:flex;align-items:center;gap:6px;box-sizing:border-box;">&#x1F3E0; Home</a>
    <!-- Background decorations -->
    <div class="bg-decoration star1">‚≠ê</div>
    <div class="bg-decoration star2">‚ú®</div>
    <div class="bg-decoration star3">üåü</div>
    <div class="bg-decoration cloud1">‚òÅÔ∏è</div>
    <div class="bg-decoration cloud2">‚òÅÔ∏è</div>

    <div class="container">
        <header>
            <h1>‚ú® Magical Coloring Adventure ‚ú®</h1>
            <div class="subtitle">üê± Read, Solve & Color! ü¶Ñ</div>
        </header>

        <div class="score-board">
            <div class="score-item">
                <div class="score-label">üéØ Level</div>
                <div class="score-value" id="level">1</div>
            </div>
            <div class="score-item">
                <div class="score-label">‚≠ê Stars</div>
                <div class="score-value" id="stars">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">üé® Colored</div>
                <div class="score-value" id="colored">0</div>
            </div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="story-section" id="storySection">
                <div class="story-text" id="storyText"></div>
                <div class="question" id="questionText"></div>
                <div class="answer-options" id="answerOptions"></div>
                <div class="feedback" id="feedback"></div>
            </div>

            <div class="coloring-section" id="coloringSection">
                <div class="coloring-instruction" id="coloringInstruction"></div>
                <div class="color-palette" id="colorPalette"></div>
                <div class="canvas-container">
                    <canvas id="coloringCanvas" width="600" height="600"></canvas>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-clear" onclick="clearCanvas()">üîÑ Start Over</button>
                    <button class="btn btn-next" onclick="nextLevel()">‚ú® Next Adventure</button>
                </div>
            </div>
        </div>
    </div>

    <div class="celebration" id="celebration">
        <h2>üéâ Amazing Work! üéâ</h2>
        <p id="celebrationText"></p>
        <button class="btn btn-next" onclick="hideCelebration()">Continue! ‚ú®</button>
    </div>

    <script>
        // Game state
        let currentLevel = 0;
        let totalStars = 0;
        let totalColored = 0;
        let selectedColor = '#9B7EBD';
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;

        // Canvas setup
        const canvas = document.getElementById('coloringCanvas');
        const ctx = canvas.getContext('2d');

        // Color palette
        const colors = [
            '#9B7EBD', // Purple
            '#5B9FE3', // Blue
            '#F5B7D5', // Pink
            '#FFD93D', // Yellow
            '#7BC96F', // Green
            '#FF9E7A', // Orange
            '#A7D7F9', // Sky Blue
            '#E5C1FF', // Lavender
            '#FFB6C1', // Light Pink
            '#FFFFFF'  // White
        ];

        // Educational content - Second grade level
        const levels = [
            {
                story: "Luna the magical cat found a treasure chest in her garden. Inside were 15 shiny gems! She gave 7 gems to her friend Sparkle the unicorn. Luna wanted to know how many gems she had left.",
                question: "How many gems does Luna have left?",
                answers: ["8 gems", "22 gems", "9 gems", "7 gems"],
                correct: 0,
                math: "15 - 7 = ?",
                image: 'cat',
                instruction: "Color Luna the magical cat! üê±‚ú®",
                comprehension: "subtraction within 20"
            },
            {
                story: "Sparkle the unicorn loves to fly through rainbow clouds. On Monday, she flew through 8 clouds. On Tuesday, she flew through 9 more clouds. Sparkle wondered how many clouds she flew through in total.",
                question: "How many clouds did Sparkle fly through altogether?",
                answers: ["16 clouds", "17 clouds", "18 clouds", "15 clouds"],
                correct: 1,
                math: "8 + 9 = ?",
                image: 'unicorn',
                instruction: "Color Sparkle the unicorn! ü¶Ñüíú",
                comprehension: "addition within 20"
            },
            {
                story: "Luna and Sparkle went on an adventure to collect star cookies. They found 12 star cookies under a tree. They ate 5 cookies for a snack. Then they wondered how many star cookies were left to share.",
                question: "How many star cookies are left?",
                answers: ["6 cookies", "8 cookies", "7 cookies", "17 cookies"],
                correct: 2,
                math: "12 - 5 = ?",
                image: 'stars',
                instruction: "Color the magical stars! ‚≠êüåü",
                comprehension: "subtraction with context clues"
            },
            {
                story: "In the Enchanted Forest, Luna counted butterflies. She saw 6 blue butterflies on a flower and 6 purple butterflies on a bush. Luna loves butterflies and wanted to count them all!",
                question: "How many butterflies did Luna see in all?",
                answers: ["11 butterflies", "13 butterflies", "12 butterflies", "10 butterflies"],
                correct: 2,
                math: "6 + 6 = ?",
                image: 'butterfly',
                instruction: "Color the beautiful butterfly! ü¶ã",
                comprehension: "doubles addition"
            },
            {
                story: "Sparkle had a big basket with 20 magic carrots. She ate 4 carrots for breakfast and 3 carrots for lunch. Now she wants to know how many magic carrots are still in her basket.",
                question: "How many magic carrots does Sparkle have left?",
                answers: ["14 carrots", "13 carrots", "12 carrots", "15 carrots"],
                correct: 1,
                math: "20 - 4 - 3 = ?",
                image: 'heart',
                instruction: "Color the magical heart! üíúüíô",
                comprehension: "two-step subtraction"
            }
        ];

        // Initialize color palette
        function initColorPalette() {
            const palette = document.getElementById('colorPalette');
            colors.forEach(color => {
                const btn = document.createElement('div');
                btn.className = 'color-btn';
                btn.style.backgroundColor = color;
                btn.onclick = () => selectColor(color, btn);
                if (color === selectedColor) {
                    btn.classList.add('selected');
                }
                palette.appendChild(btn);
            });
        }

        function selectColor(color, btn) {
            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedColor = color;
        }

        // Touch and mouse drawing
        function getCoordinates(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            if (e.touches && e.touches[0]) {
                return {
                    x: (e.touches[0].clientX - rect.left) * scaleX,
                    y: (e.touches[0].clientY - rect.top) * scaleY
                };
            } else {
                return {
                    x: (e.clientX - rect.left) * scaleX,
                    y: (e.clientY - rect.top) * scaleY
                };
            }
        }

        function startDrawing(e) {
            e.preventDefault();
            isDrawing = true;
            const coords = getCoordinates(e);
            lastX = coords.x;
            lastY = coords.y;
        }

        function draw(e) {
            e.preventDefault();
            if (!isDrawing) return;
            
            const coords = getCoordinates(e);
            ctx.strokeStyle = selectedColor;
            ctx.lineWidth = 15;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(coords.x, coords.y);
            ctx.stroke();
            
            lastX = coords.x;
            lastY = coords.y;
        }

        function stopDrawing(e) {
            e.preventDefault();
            isDrawing = false;
        }

        // Canvas event listeners
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDrawing);

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawCurrentImage();
        }

        // Draw coloring images
        function drawCurrentImage() {
            const level = levels[currentLevel];
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 4;
            ctx.fillStyle = '#FFF';

            if (level.image === 'cat') {
                drawCat();
            } else if (level.image === 'unicorn') {
                drawUnicorn();
            } else if (level.image === 'stars') {
                drawStars();
            } else if (level.image === 'butterfly') {
                drawButterfly();
            } else if (level.image === 'heart') {
                drawHeart();
            }
        }

        function drawCat() {
            // Cat head
            ctx.beginPath();
            ctx.arc(300, 250, 120, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Ears
            ctx.beginPath();
            ctx.moveTo(220, 180);
            ctx.lineTo(180, 120);
            ctx.lineTo(250, 140);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(380, 180);
            ctx.lineTo(420, 120);
            ctx.lineTo(350, 140);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Eyes
            ctx.beginPath();
            ctx.arc(260, 230, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(340, 230, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Nose
            ctx.beginPath();
            ctx.moveTo(300, 270);
            ctx.lineTo(290, 285);
            ctx.lineTo(310, 285);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Whiskers
            ctx.beginPath();
            ctx.moveTo(200, 250);
            ctx.lineTo(150, 240);
            ctx.moveTo(200, 270);
            ctx.lineTo(150, 275);
            ctx.moveTo(400, 250);
            ctx.lineTo(450, 240);
            ctx.moveTo(400, 270);
            ctx.lineTo(450, 275);
            ctx.stroke();

            // Body
            ctx.beginPath();
            ctx.ellipse(300, 420, 100, 130, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Tail
            ctx.beginPath();
            ctx.moveTo(380, 450);
            ctx.quadraticCurveTo(480, 400, 470, 320);
            ctx.stroke();
        }

        function drawUnicorn() {
            // Head
            ctx.beginPath();
            ctx.arc(300, 280, 100, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Horn
            ctx.beginPath();
            ctx.moveTo(300, 180);
            ctx.lineTo(280, 240);
            ctx.lineTo(320, 240);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Horn spiral
            for (let i = 0; i < 3; i++) {
                ctx.beginPath();
                ctx.moveTo(285 + i * 10, 200 + i * 15);
                ctx.lineTo(315 - i * 10, 200 + i * 15);
                ctx.stroke();
            }

            // Ears
            ctx.beginPath();
            ctx.moveTo(240, 230);
            ctx.lineTo(220, 200);
            ctx.lineTo(250, 210);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(360, 230);
            ctx.lineTo(380, 200);
            ctx.lineTo(350, 210);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Eyes
            ctx.beginPath();
            ctx.arc(270, 270, 12, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(330, 270, 12, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Nose
            ctx.beginPath();
            ctx.arc(300, 310, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Body
            ctx.beginPath();
            ctx.ellipse(300, 450, 90, 120, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Legs
            ctx.fillRect(250, 520, 30, 60);
            ctx.strokeRect(250, 520, 30, 60);
            ctx.fillRect(320, 520, 30, 60);
            ctx.strokeRect(320, 520, 30, 60);

            // Mane
            ctx.beginPath();
            ctx.moveTo(240, 250);
            ctx.quadraticCurveTo(180, 280, 200, 350);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(250, 240);
            ctx.quadraticCurveTo(200, 260, 220, 330);
            ctx.stroke();
        }

        function drawStars() {
            // Draw multiple stars
            drawStar(200, 200, 60);
            drawStar(400, 200, 60);
            drawStar(300, 380, 80);
        }

        function drawStar(cx, cy, size) {
            ctx.beginPath();
            for (let i = 0; i < 5; i++) {
                const angle = (i * 4 * Math.PI) / 5 - Math.PI / 2;
                const x = cx + Math.cos(angle) * size;
                const y = cy + Math.sin(angle) * size;
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
        }

        function drawButterfly() {
            // Left wing
            ctx.beginPath();
            ctx.ellipse(200, 250, 80, 100, -0.3, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            ctx.beginPath();
            ctx.ellipse(190, 380, 60, 80, -0.3, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Right wing
            ctx.beginPath();
            ctx.ellipse(400, 250, 80, 100, 0.3, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            ctx.beginPath();
            ctx.ellipse(410, 380, 60, 80, 0.3, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Body
            ctx.beginPath();
            ctx.ellipse(300, 300, 25, 120, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Head
            ctx.beginPath();
            ctx.arc(300, 200, 30, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Antennae
            ctx.beginPath();
            ctx.moveTo(290, 180);
            ctx.quadraticCurveTo(270, 150, 260, 140);
            ctx.moveTo(310, 180);
            ctx.quadraticCurveTo(330, 150, 340, 140);
            ctx.stroke();

            // Antenna ends
            ctx.beginPath();
            ctx.arc(260, 140, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(340, 140, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Wing patterns
            ctx.beginPath();
            ctx.arc(200, 250, 20, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.arc(400, 250, 20, 0, Math.PI * 2);
            ctx.stroke();
        }

        function drawHeart() {
            ctx.beginPath();
            ctx.moveTo(300, 500);
            ctx.bezierCurveTo(300, 450, 250, 400, 200, 400);
            ctx.bezierCurveTo(150, 400, 150, 450, 150, 470);
            ctx.bezierCurveTo(150, 520, 200, 570, 300, 600);
            ctx.bezierCurveTo(400, 570, 450, 520, 450, 470);
            ctx.bezierCurveTo(450, 450, 450, 400, 400, 400);
            ctx.bezierCurveTo(350, 400, 300, 450, 300, 500);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Smaller heart inside
            ctx.beginPath();
            ctx.moveTo(300, 450);
            ctx.bezierCurveTo(300, 420, 270, 390, 240, 390);
            ctx.bezierCurveTo(210, 390, 210, 420, 210, 435);
            ctx.bezierCurveTo(210, 470, 240, 500, 300, 530);
            ctx.bezierCurveTo(360, 500, 390, 470, 390, 435);
            ctx.bezierCurveTo(390, 420, 390, 390, 360, 390);
            ctx.bezierCurveTo(330, 390, 300, 420, 300, 450);
            ctx.closePath();
            ctx.stroke();
        }

        // Load level
        function loadLevel() {
            const level = levels[currentLevel];
            
            document.getElementById('storyText').textContent = level.story;
            document.getElementById('questionText').textContent = level.question;
            document.getElementById('level').textContent = currentLevel + 1;
            
            const optionsContainer = document.getElementById('answerOptions');
            optionsContainer.innerHTML = '';
            
            level.answers.forEach((answer, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = answer;
                btn.onclick = () => checkAnswer(index);
                optionsContainer.appendChild(btn);
            });
            
            document.getElementById('feedback').textContent = '';
            document.getElementById('coloringSection').classList.remove('active');
            document.getElementById('storySection').style.display = 'block';
        }

        function checkAnswer(selectedIndex) {
            const level = levels[currentLevel];
            const buttons = document.querySelectorAll('.answer-btn');
            const feedback = document.getElementById('feedback');
            
            buttons.forEach(btn => btn.disabled = true);
            
            if (selectedIndex === level.correct) {
                buttons[selectedIndex].classList.add('correct');
                feedback.textContent = 'üéâ Perfect! You solved it!';
                feedback.className = 'feedback correct';
                totalStars++;
                document.getElementById('stars').textContent = totalStars;
                
                setTimeout(() => {
                    showColoringSection();
                }, 1500);
            } else {
                buttons[selectedIndex].classList.add('incorrect');
                buttons[level.correct].classList.add('correct');
                feedback.textContent = 'üí™ Try again! Look at the story carefully.';
                feedback.className = 'feedback incorrect';
                
                setTimeout(() => {
                    buttons.forEach(btn => {
                        btn.disabled = false;
                        btn.classList.remove('correct', 'incorrect');
                    });
                    feedback.textContent = '';
                }, 2000);
            }
        }

        function showColoringSection() {
            document.getElementById('storySection').style.display = 'none';
            const coloringSection = document.getElementById('coloringSection');
            coloringSection.classList.add('active');
            
            const level = levels[currentLevel];
            document.getElementById('coloringInstruction').textContent = level.instruction;
            
            drawCurrentImage();
        }

        function nextLevel() {
            totalColored++;
            document.getElementById('colored').textContent = totalColored;
            
            if (currentLevel < levels.length - 1) {
                currentLevel++;
                loadLevel();
            } else {
                showFinalCelebration();
            }
        }

        function showFinalCelebration() {
            const celebration = document.getElementById('celebration');
            const celebrationText = document.getElementById('celebrationText');
            
            celebrationText.textContent = `You completed all ${levels.length} adventures and earned ${totalStars} stars! You're a reading and math superstar! üåü`;
            celebration.classList.add('active');
        }

        function hideCelebration() {
            const celebration = document.getElementById('celebration');
            celebration.classList.remove('active');
            
            // Restart game
            currentLevel = 0;
            totalStars = 0;
            totalColored = 0;
            document.getElementById('stars').textContent = totalStars;
            document.getElementById('colored').textContent = totalColored;
            loadLevel();
        }

        // Initialize game
        initColorPalette();
        loadLevel();
    </script>
</body>
</html>
